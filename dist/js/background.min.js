chrome.browserAction.onClicked.addListener(function(a){if(background.isUrl(a.url)){chrome.tabs.executeScript(null,{code:"window.getSelection().toString();"},function(b){if(b&&b[0]){background.openTextUrl(b[0])}else{background.openLinkUrl(a.url)}})}});chrome.contextMenus.create({title:chrome.i18n.getMessage("title")+" “%s”",contexts:["selection"],onclick:function(a){if(a.selectionText){background.openTextUrl(a.selectionText)}}});background={isUrl:function(a){if(!a){return false}return(new RegExp("^http[s]?://.*")).test(a)},openTextUrl:function(a){chrome.storage.sync.get("_gtlc",function(b){var d=b._gtlc?b._gtlc:chrome.i18n.getUILanguage();var c="https://translate.google.com/?source=yii#auto/"+d+"/"+encodeURIComponent(a);chrome.tabs.create({url:c})})},openLinkUrl:function(a){chrome.storage.sync.get("_gtlc",function(b){var d=b._gtlc?b._gtlc:chrome.i18n.getUILanguage();var c="http://translate.google.com/translate?source=yii&js=n&sl=auto&tl="+d+"&u="+encodeURIComponent(a);chrome.tabs.create({url:c})})}};